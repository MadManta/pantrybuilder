<!DOCTYPE html>
<html lang="en-us">

<head>
   <link rel="stylesheet" type="text/css" href="assets/css/style.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link href="https://afeld.github.io/emoji-css/emoji.css" rel="stylesheet">

  <i class="em em-some-emoji"></i>

    <meta charset="UTF-8">
    <title>Pantry Planner!</title>
    <style>

    </style>
</head>

<body>
    <!-- Title -->
    <div class="jumbotron jumbotron-fluid">
        <div class="container">
            <h1 class="display-3">Pantry Planner</h1>
            <p class="lead">A handy app to help you manage your pantry and grocery list!</p>
        </div>
    </div>
    <!-- Input Form -->
    <div class="container">
        <div class="col-xs-8 col xs-offset-2">
        </div>
    </div>
    <hr>
    
    <!-- food list -->
    <div id="accordion">
        <div class="card">
            <div class="card-header" id="headingOne">
                <h5 class="mb-0">
                    <button class="btn btn-link" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                      <i><i class="em em-bacon"></i></i> 
                        Food List
                    </button>
                    
                </h5>
            </div>
            <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordion">
                <div class="row">
                    <div class="col-1">
                    </div>
                    <div class="col-7">
                        <div>
                            <form class="form-inline">
                                <input class="form-control mr-sm-2 form-control-sm" type="search" placeholder="eg Fridge" id="addsection" aria-label="Search">
                                <button class="btn btn-outline-success my-2 my-sm-0 btn-sm" id="sortsection" type="submit">Add Shelf</button>
                            </form>
                            <ul id="pantry" class="js-sortable sortable list">
                        </div>
                    </div>
                    <!-- API SEARCH BUTTON-->
                    <div class="col-4">
                        <div class="addfood">
                            <form class="form-inline">
                                <input class="form-control mr-sm-2" type="search" placeholder="Search" id="additem" aria-label="Search">
                                <button class="btn btn-outline-success my-2 my-sm-0" id="submit" type="submit">Add Food</button>
                            </form>
                        </div>
                        <div id="listfood">
                            
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-header" id="headingTwo">
                <h5 class="mb-0">
                    <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                      <i><i class="em em-canned_food"></i></i>
                        Grocery List
                       
                    </button>
                </h5>
            </div>
            <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
                <div class="card-body">
                    <div class="row">
                        <div class="col-1">
                        </div>
                        <div class="col-7">
                            <ul id="grocerylist">
                        </div>
                        <!-- API SEARCH BUTTON-->
                        <div class="col-4">
                            <div class="addshoppinglist">
                                <form class="form-inline">
                                    <input class="form-control mr-sm-2" type="search" placeholder="Search" id="addshopping" aria-label="Search">
                                    <button class="btn btn-outline-success my-2 my-sm-0" id="grocery" type="submit">Add Food</button>
                                </form>
                            </div>
                            <div id="groceryusda">
                                search results here
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-header" id="headingThree">
                <h5 class="mb-0">
                    <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                      <i><i class="em em-dango"></i></i>
                        Recipe Search
                        
                    </button>
                </h5>
            </div>
            <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">
                <div class="card-body">
                    <div class="form-group">
                        <label for="recipeName">Recipe Name: </label>
                        <input type="text" id="recipeName">
                    </div>
                    <table id="ingTable" class="table">
                        <thead>
                            <tr>
                                <th id="tableIng">Ingredient</th>
                                <th id="tableMeas">Amt.</th>
                                <th id="tableUnit">Unit</th>
                                <th id="tableAdd"></th>
                </div>
            </div>
            </tr>
            </thead>
            <tbody id="ingredients">
                <div class="form-group row">
                    <td>
                        <!--where to enter the name of the ingredient-->
                        <input type="text" class="form-control ingredient" id="ing1">
                    </td>
                    <td>
                        <!--enter the amount as a number-->
                        <input type="number" class="form-control measure" id="meas1">
                    </td>
                    <td>
                        <!--enter the unit of measure-->
                        <select class="form-control unit" id="unit1">
                            <option>-----</option>
                            <option>each</option>
                            <option>tsp</option>
                            <option>Tbsp</option>
                            <option>cup(s)</option>
                            <option>qt</option>
                            <option>gal</option>
                            <option>oz</option>
                            <option>lbs</option>
                            <option>ml</option>
                            <option>L</option>
                            <option>mg</option>
                            <option>g</option>
                            <option>Kg</option>
                        </select>
                    </td>
                    <td>
                        <!--button to add another ingredient-->
                        <button class="addIngredient" id="addIng1"><strong>+</strong></button>
                    </td>
                </div>
            </tbody>
            </table>
            <div class="form-group">
                <label for="directions">Directions:</label>
                <textarea class="form-control" id="directions" rows="5"></textarea>
            </div>
            <button class="btn btn-primary" id="addRecipe">Done</button>
        </div>
    </div>
    </div>
    </div>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script src="html5sortable.js"></script>
    <!-- Script -->
    <script>
    //bobs recipe query

    //Sammy's Grocery add API

    $("#grocery").on("click", function(event) {
        event.preventDefault();
        var additem = $("#addshopping").val().trim();
        $("#groceryusda").empty();
        var queryURL = "https://api.nal.usda.gov/ndb/search/?&format=json&q=" + additem + "&ds=Standard+Reference&sort=r&max=10&offset=0&api_key=uyNSkR4G2nmzLN1z7unvxh1JMdwZ0IXiPP8k1QXE";
        $.ajax({
            url: queryURL,
            method: 'GET'
        }).then(function(response) {
            console.log(response);
            var results = response.list.item;

            for (var i = 0; i < results.length; i++) {
                var foodDiv = $("<div>");
                var list = $("<li>");
                list.html(results[i].name);
                list.attr("data-id", results[i].name);
                foodDiv.append(list);
                $("#groceryusda").append(foodDiv);
            };
            console.log(results)

            $("li").on("click", function(event) {
                var newFood = $(this).data("id");
                $("#grocerylist").append("<li>" + newFood + "</li>");
                console.log(newFood);
            });
        });
    });
    //Sammy's Sort Items
    $(function() {
        $(".sortable").sortable();
        $(".sortable").disableSelection();
    });
    //Sammy's Add a Shelf Section
    $("#sortsection").on("click", function(event) {
        event.preventDefault();
        var newSection = $("#addsection").val().trim();
        $("#pantry").append("<ul class='sortable'>" + newSection);
    });
    //Sammy's food API
    $("#submit").on("click", function(event) {
        event.preventDefault();
        var additem = $("#additem").val().trim();
        $("#listfood").empty();
        var queryURL = "https://api.nal.usda.gov/ndb/search/?&format=json&q=" + additem + "&ds=Standard+Reference&sort=r&max=10&offset=0&api_key=uyNSkR4G2nmzLN1z7unvxh1JMdwZ0IXiPP8k1QXE";
        $.ajax({
            url: queryURL,
            method: 'GET'
        }).then(function(response) {
            console.log(response);
            var results = response.list.item;
            for (var i = 0; i < results.length; i++) {
                var foodDiv = $("<div>");
                var list = $("<li>");
                list.html(results[i].name);
                list.attr("data-id", results[i].name);
                foodDiv.append(list);
                $("#listfood").append(foodDiv);
            };
            console.log(results)
            $("li").on("click", function(event) {
                var newFood = $(this).data("id");
                $("#pantry").append("<li class='ui-state-default'>" + newFood + "</li>");
                console.log(newFood);
            });
        });
    });
    var $ingredients = $("#ingredients"),
        $recipeName = $("#recipeName");
    $directions = $("#directions"),
        $addRecipe = $("#addRecipe");
    //ingredient counter
    var currentIngredient = 1;
    //array of recipe objects
    var myRecipes = JSON.parse(localStorage.getItem("recipes")) || [];
    //event listener to add an ingredient
    $(document).on("click", ".addIngredient", function(event) {
        event.preventDefault();
        //hide the current button.
        $("#addIng" + currentIngredient).css({ "visibility": "hidden" });
        //Increment the ingredient counter
        currentIngredient++;
        //append a new row to the ingredients table
        $ingredients.append("<tr>" +
            "<div class = 'form-group row'>" +
            "<td>" +
            "<input type = 'text' class = 'form-control ingredient' id = 'ing" + currentIngredient + "'>" +
            "</td>" +
            "<td>" +
            "<input type = 'number' class = 'form-control measure' id = 'meas" + currentIngredient + "'>" +
            "</td>" +
            "<td>" +
            "<select class = 'form-control unit' id = 'unit" + currentIngredient + "'>" +
            "<option>-----</option>" +
            "<option>each</option" +
            "<option>tsp</option>" +
            "<option>Tbsp</option>" +
            "<option>cup(s)</option>" +
            "<option>qt</option>" +
            "<option>gal</option>" +
            "<option>oz</option>" +
            "<option>lbs</option>" +
            "<option>ml</option>" +
            "<option>L</option>" +
            "<option>mg</option>" +
            "<option>g</option>" +
            "<option>Kg</option>" +
            "</select>" +
            "</td>" +
            "<td>" +
            "<button class = 'addIngredient' id = 'addIng" + currentIngredient + "'><strong>+</strong></button>" +
            "</td>" +
            "</div></tr>"
        );
    });
    //event listener to submit a recipe
    $addRecipe.click(function(event) {
        //pull the values from the form as variables
        var name = $recipeName.val().trim();
        var directions = $directions.val().trim();
        var ingredients = [],
            measures = [],
            units = [];
        for (var i = 1; i <= currentIngredient; i++) {
            ingredients.push($("#ing" + i).val().trim());
            measures.push($("#meas" + i).val());
            units.push($("#unit" + i).val());
        }
        //create a new object from the values
        var recipe = {
            name: name,
            ingredients: ingredients,
            measures: measures,
            units: units,
            directions: directions
        }
        console.log(recipe);
        //add our new recipe to myRecipes
        myRecipes.push(recipe);
        //update the local storage (eventually the database)
        localStorage.clear();
        localStorage.setItem("recipes", JSON.stringify(myRecipes));
        //reset the form
        currentIngredient = 1;
        $directions.val("");
        $ingredients.html("<tr>" +
            "<div class = 'form-group row'>" +
            "<td>" +
            "<input type = 'text' class = 'form-control ingredient' id = 'ing" + currentIngredient + "'>" +
            "</td>" +
            "<td>" +
            "<input type = 'number' class = 'form-control measure' id = 'meas" + currentIngredient + "'>" +
            "</td>" +
            "<td>" +
            "<select class = 'form-control unit' id = 'unit" + currentIngredient + "'>" +
            "<option>-----</option>" +
            "<option>each</option" +
            "<option>tsp</option>" +
            "<option>Tbsp</option>" +
            "<option>cup(s)</option>" +
            "<option>qt</option>" +
            "<option>gal</option>" +
            "<option>oz</option>" +
            "<option>lbs</option>" +
            "<option>ml</option>" +
            "<option>L</option>" +
            "<option>mg</option>" +
            "<option>g</option>" +
            "<option>Kg</option>" +
            "</select>" +
            "</td>" +
            "<td>" +
            "<button class = 'addIngredient' id = 'addIng" + currentIngredient + "'><strong>+</strong></button>" +
            "</td>" +
            "</div></tr>"
        );
    });
    </script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>
    <script src="jquery-ui.js"></script>
</body>

</html>